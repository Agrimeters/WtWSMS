##############################################################################################################
# Garamantes event chain
#
# Story written by Hatefig, events implemented by IhateTrains
# https://forum.paradoxplaza.com/forum/index.php?threads/wtwsms-suggestions-ideas.827029/page-60#post-23673893
##############################################################################################################

namespace = WtWSMS_garama

narrative_event = {
	id = WtWSMS_garama.1
	title = WtWSMS_garama.1.name
	desc = WtWSMS_garama.1.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	trigger = {
		OR = {
			has_landed_title = k_garamantes
			liege = { has_landed_title = k_garamantes }
		}
		NOR = {
			has_global_flag = first_garamantes_event_chain_started
			has_global_flag = first_garamantes_event_chain_completed
		}
		war = no
		age = 16
	}
	
	mean_time_to_happen = { months = 6 }
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.100 }
	}
}
narrative_event = {
	id = WtWSMS_garama.100
	title = WtWSMS_garama.1.name
	desc = WtWSMS_garama.100.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.1 }
	}
	option = {
		name = WtWSMS_garama.1.a #Event chain starts
		narrative_event = { id = WtWSMS_garama.2 days = 10 }
		set_global_flag = first_garamantes_event_chain_started
	}
	option = {
		name = WtWSMS_garama.1.b #Player will not get the event chain
	}
}
narrative_event = {
	id = WtWSMS_garama.2
	title = WtWSMS_garama.2.name
	desc = WtWSMS_garama.2.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.200 }
	}
	
	
}
narrative_event = {
	id = WtWSMS_garama.200
	title = WtWSMS_garama.2.name
	desc = WtWSMS_garama.200.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.2 }
	}
	option = {
		name = WtWSMS_garama.2.a
		narrative_event = { id = WtWSMS_garama.3 days = 1800 random = 1800 }
	}
}
narrative_event = {
	id = WtWSMS_garama.3
	title = WtWSMS_garama.3.name
	desc = WtWSMS_garama.3.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.300 }
	}
}
narrative_event = {
	id = WtWSMS_garama.300
	title = WtWSMS_garama.3.name
	desc = WtWSMS_garama.300.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.3 }
	}
	option = {
		name = WtWSMS_garama.3.a
		narrative_event = { id = WtWSMS_garama.4 days = 1800 }
	}
}
narrative_event = {
	id = WtWSMS_garama.4
	title = WtWSMS_garama.4.name
	desc = WtWSMS_garama.4.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.400 }
	}
}
narrative_event = {
	id = WtWSMS_garama.400
	title = WtWSMS_garama.4.name
	desc = WtWSMS_garama.400.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.4 }
	}
	option = {
		name = WtWSMS_garama.4.a
		trigger = { religion = aten_pagan }
		if = {
			limit = { any_province = { religion = aten_pagan } }
			random_province = {
				limit = { religion = aten_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = aten_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		if = {
			limit = { any_province = { religion = egyptian_pagan } }
			random_province = {
				limit = { religion = egyptian_pagan }
				religion_authority = {
					modifier = recent_events_negative
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = egyptian_pagan }
				religion_authority = {
					modifier = recent_events_negative
					years = 20
				}
			}
		}
		narrative_event = { id = WtWSMS_garama.5 days = 1800 }
	}
	option = {
		name = WtWSMS_garama.4.b
		trigger = { NOT = { religion = aten_pagan } }
		if = {
			limit = { any_province = { religion = aten_pagan } }
			random_province = {
				limit = { religion = aten_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = aten_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		if = {
			limit = { any_province = { religion = egyptian_pagan } }
			random_province = {
				limit = { religion = egyptian_pagan }
				religion_authority = {
					modifier = recent_events_negative
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = egyptian_pagan }
				religion_authority = {
					modifier = recent_events_negative
					years = 20
				}
			}
		}
		narrative_event = { id = WtWSMS_garama.5 days = 1800 }
	}
}
narrative_event = {
	id = WtWSMS_garama.5
	title = WtWSMS_garama.5.name
	desc = WtWSMS_garama.5.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.500 }
	}
	
}
narrative_event = {
	id = WtWSMS_garama.500
	title = WtWSMS_garama.5.name
	desc = WtWSMS_garama.500.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = first_garamantes_event_chain_completed
		clr_global_flag = first_garamantes_event_chain_started
	}
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.5 }
	}
	option = {
		name = WtWSMS_garama.5.a
		trigger = {
			OR = {
				religion = central_african_pagan_reformed
				religion = central_african_pagan
			}
		}
		if = {
			limit = { any_character = { religion = central_african_pagan_reformed } }
			random_character = {
				limit = { religion = central_african_pagan_reformed }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = central_african_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
	}
	option = {
		name = WtWSMS_garama.5.b
		trigger = {
			NOR = {
				religion = central_african_pagan_reformed
				religion = central_african_pagan
			}
		}
		if = {
			limit = { any_character = { religion = central_african_pagan_reformed } }
			random_character = {
				limit = { religion = central_african_pagan_reformed }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
		else = {
			random_character = {
				limit = { religion = central_african_pagan }
				religion_authority = {
					modifier = recent_events_positive
					years = 20
				}
			}
		}
	}
}

#Second event chain
narrative_event = {
	id = WtWSMS_garama.6
	title = WtWSMS_garama.6.name
	desc = WtWSMS_garama.6.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	trigger = {
		had_global_flag = { flag = first_garamantes_event_chain_completed days = 3600 }
		year > 520
		OR = {
			has_landed_title = k_garamantes
			liege = { has_landed_title = k_garamantes }
		}
		war = no
		age = 16
		k_garamantes = {
			holder_scope = {
				OR = {
					religion = egyptian_pagan
					religion = aten_pagan
				}
			}
		}
		any_realm_lord = {
			religion = central_african_pagan
			religion = central_african_pagan_reformed
		}
		NOT = { any_realm_province = { region = custom_diocese_aegyptus } }
	}
	
	mean_time_to_happen = { months = 6 } #some randomness
	
	option = {
		name = WtWSMS_garama.0.a #read more
		narrative_event = { id = WtWSMS_garama.600 }
	}
}
narrative_event = {
	id = WtWSMS_garama.600
	title = WtWSMS_garama.6.name
	desc = WtWSMS_garama.600.desc
	picture = GFX_evt_pyramid
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.0.b #return to first page
		narrative_event = { id = WtWSMS_garama.6 }
	}
	option = {
		name = WtWSMS_garama.6.a
		
		add_character_modifier = { name = peasant_unrest days = 1800 }
		gold = -5
		
		set_global_flag = second_garamantes_event_chain_started
		any_realm_lord = {
			limit = {
				religion = {
					OR = {
						religion = central_african_pagan
						religion = central_african_pagan_reformed
					}
				}
			}
			set_character_flag = garama_central_african_conspirant
		}
		k_garamantes = { holder_scope = { narrative_event = { id = WtWSMS_garama.7 days = 360 } } }
		narrative_event = { id = WtWSMS_garama.10 days = 540 }
	}
	option = {
		name = WtWSMS_garama.6.b
		trigger = {
			OR = {
				trait = kind
				trait = generous
			}
		}
		
		add_character_modifier = { name = minor_food_shortage days = 360 }
		
		set_global_flag = second_garamantes_event_chain_started
		any_realm_lord = {
			limit = {
				religion = {
					OR = {
						religion = central_african_pagan
						religion = central_african_pagan_reformed
					}
				}
			}
			set_character_flag = garama_central_african_conspirant
		}
		k_garamantes = { holder_scope = { narrative_event = { id = WtWSMS_garama.7 days = 360 } } }
		narrative_event = { id = WtWSMS_garama.10 days = 540 }
	}
	option = {
		name = WtWSMS_garama.6.c
		
		trigger = {
			OR = {
				trait = cruel
				trait = zealous
			}
		}
		add_character_modifier = { name = peasant_crisis days = 720 }
		
		set_global_flag = second_garamantes_event_chain_started
		any_realm_lord = {
			limit = {
				religion = {
					OR = {
						religion = central_african_pagan
						religion = central_african_pagan_reformed
					}
				}
			}
			set_character_flag = garama_central_african_conspirant
		}
		k_garamantes = { holder_scope = { narrative_event = { id = WtWSMS_garama.7 days = 360 } } }
		narrative_event = { id = WtWSMS_garama.10 days = 540 }
	}
}
narrative_event = { #fires for a Kemetic or Atenic Pharaoh only
	id = WtWSMS_garama.7
	title = WtWSMS_garama.7.name
	desc = WtWSMS_garama.7.desc
	picture = GFX_evt_nightmare
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = egyptian_pagan
			religion = aten_pagan
		}
	}
	
	option = {
		name = WtWSMS_garama.7.a
		
		narrative_event = { id = WtWSMS_garama.8 } #bad result
	}
	option = {
		name = WtWSMS_garama.7.b
		
		hidden_tooltip = {
			random_list = {
				50 = {
					narrative_event = { id = WtWSMS_garama.8 } #bad result
				}
				50 = {
					narrative_event = { id = WtWSMS_garama.9 } #good result
				}
			}
		}
		
	}
	option = {
		name = WtWSMS_garama.7.c
		
		hidden_tooltip = {
			random_list = {
				20 = {
					death = { death_reason = death_murder_unknown_butchered }
				}
				80 = {
					narrative_event = { id = WtWSMS_garama.9 } #good result
				}
			}
		}
	}
}
narrative_event = { #bad result
	id = WtWSMS_garama.8
	title = WtWSMS_garama.8.name
	desc = WtWSMS_garama.8.desc
	picture = GFX_evt_nightmare
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.8.a
	}
}
narrative_event = {
	id = WtWSMS_garama.9 #good result
	title = WtWSMS_garama.9.name
	desc = WtWSMS_garama.9.desc
	picture = GFX_evt_nightmare
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	immediate = { set_character_flag = light_in_the_dark_good_result }
	
	option = {
		name = WtWSMS_garama.9.a
	}
}
narrative_event = {
	id = WtWSMS_garama.10
	title = WtWSMS_garama.10.name
	desc = WtWSMS_garama.10.desc
	picture = GFX_evt_small_town_east_african
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = garama_central_african_conspirant
	}
	
	option = {
		name = WtWSMS_garama.10.a
		ai_chance = {
			factor = 50
		}
	}
	option = {
		name = WtWSMS_garama.10.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				k_garamantes = { holder_scope = { ROOT = { opinion = { who = PREV value >= 40 } } } }
			}
		}
		k_garamantes = { holder_scope = { ROOT = { opinion = { modifier = opinion_hate who = PREV years = 20 } } } }
		add_trait = traveling
		narrative_event = { id = WtWSMS_garama.11 days = 90 }
	}
}
narrative_event = {
	id = WtWSMS_garama.11
	title = WtWSMS_garama.11.name
	desc = WtWSMS_garama.11.desc
	picture = GFX_evt_small_town_east_african
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = WtWSMS_garama.11.a
		
		remove_trait = traveling
		random = { chance = 20 add_trait = zealous }
		k_garamantes = { holder_scope = { narrative_event = WtWSMS_garama.12 days = 30 } }
	}
}
narrative_event = {
	id = WtWSMS_garama.12
	title = WtWSMS_garama.12.name
	desc = WtWSMS_garama.12.desc
	picture = GFX_evt_small_town_east_african
	border = GFX_event_narrative_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	trigger = { has_character_flag = light_in_the_dark_good_result }
	
	option = {
		name = WtWSMS_garama.12.a
	}
}